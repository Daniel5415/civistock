{% extends "base.html" %}

{% block title %}Existencias - Ingeniero{% endblock %}

{% block content %}
  <a href="{{ url_for('ingeniero.dashboard') }}" class="btn-volver">← Volver al dashboard</a>

  <h2 class="mb-4">Inventario disponible</h2>

  <!-- Barra de búsqueda justo debajo del título -->
  <div class="mb-4" style="max-width: 400px;">
    <input type="text" id="busqueda" placeholder="Buscar material..." class="form-control">
  </div>

  {% if materiales %}
    <table id="tabla-materiales">
      <thead>
        <tr>
          <th>Código</th>
          <th>Nombre</th>
          <th>Descripción</th>
          <th>Unidad</th>
          <th>Stock</th>
        </tr>
      </thead>
      <tbody>
        {% for material in materiales %}
          <tr>
            <td>{{ material.codigo }}</td>
            <td>{{ material.nombre }}</td>
            <td>{{ material.descripcion }}</td>
            <td>{{ material.unidad }}</td>
            <td>{{ material.stock|formatear_numero }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No hay materiales registrados.</p>
  {% endif %}

  <script>
    // Filtro para la tabla
    document.getElementById("busqueda").addEventListener("keyup", function() {
      let filtro = this.value.toLowerCase();
      let filas = document.querySelectorAll("#tabla-materiales tbody tr");
      filas.forEach(function(fila) {
        let texto = fila.innerText.toLowerCase();
        fila.style.display = texto.includes(filtro) ? "" : "none";
      });
    });
  </script>
{% endblock %}
